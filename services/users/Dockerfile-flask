FROM python:3.5.3-alpine
WORKDIR /usr/src/app
EXPOSE 80

# add files and install requirements
COPY Pipfile* ./
COPY gunicorn.conf /gunicorn.conf
RUN pip install pipenv gunicorn
RUN pipenv install --system

# configure pudb not to show a welcome screen
RUN sed 's/seen_welcome = a/seen_welcome = e034/g' ~/.config/pudb/pudb.cfg -i || true

# add the app
COPY src ./

# run server
CMD ["gunicorn", "--config", "/gunicorn.conf", "-b", ":80", "wsgi:app"]
